<html>
<head>
    <title>Request</title>
    <script src="https://unpkg.com/htmx.org@1.9.12" integrity="sha384-ujb1lZYygJmzgSwoxRggbCHcjc0rB2XoQrxeTUQyRjrOnlCoYta87iKBWq3EsdM2" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.10/dist/cdn.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">


    <style>
        .highlighted {
            background-color: navy;
        }
    </style>
    <script>
        const rows = document.querySelectorAll('tbody tr');
        rows.forEach(row => {
            row.addEventListener('click', () => {
                console.log("table clicked on")
                // Remove the 'highlighted' class from all rows
                rows.forEach(r => r.classList.remove('highlighted'));
                
                // Add the 'highlighted' class to the clicked row
                row.classList.add('highlighted');
            });
        });


        function attachListeners() {
            const rows = document.querySelectorAll('tbody tr');
        rows.forEach(row => {
            row.addEventListener('click', () => {
                console.log("table clicked on")
                // Remove the 'highlighted' class from all rows
                rows.forEach(r => r.classList.remove('highlighted'));
                
                // Add the 'highlighted' class to the clicked row
                row.classList.add('highlighted');
            });
        });
        }

        // Initial call to attach listeners to the existing content
        attachListeners();

        // Listen for HTMX content load and re-attach the event listeners
        document.addEventListener('htmx:afterOnLoad', function(event) {
            // Re-attach listeners after HTMX loads new content
            attachListeners();
        });
    </script>

</head>
<body>
    <h1>Hello world!</h1>
    {{ template "toolbar" }}
    {{ template "table" }}
    {{ template "requestDetail"}}
</body>
</html>
